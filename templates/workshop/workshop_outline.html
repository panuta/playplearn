{% extends 'base.html' %}
{% load thumbnail common_tags presentation_tags %}

{% block head_title %}{{ workshop.title }} - {{ settings.WEBSITE_NAME }}{% endblock %}
{% block body_class %}page-workshop-outline{% endblock %}

{% block scripts %}
<script>
(function() {
    {% if workshop_pictures %}
        $('#pictures-slider').royalSlider({
            controlsInside: false,
            globalCaption: true,
            imageScaleMode: 'fill',
            keyboardNavEnabled: true
        });
    {% endif %}

    var scheduleArray = [{% course_schedule_start_datetime_as_comma_separated course_schedules %}]

    $( "#enrollment-calendar" ).datepicker({
        showOtherMonths: true,
        beforeShowDay: function (date) {
            var theday = date.getFullYear() + '/' + (date.getMonth() + 1) + '/' + date.getDate();
            return [false, $.inArray(theday, scheduleArray) >=0 ? 'schedule-date' : ''];
        }
    });

    $('.button-show-all-schedules').on('click', function() {
        $('.schedules-list li').removeClass('hide');
        $(this).closest('li').remove();
        return false;
    });

    $('.workshop-feedbacks .feedbacks').masonry({
        columnWidth: 540,
        gutter: 50,
        itemSelector: '.style-course-feedback'
    });

})();
</script>
{% endblock %}

{% block body %}
<div class="container">
    <h1>{{ workshop.title }}</h1>

    <div class="workshop-teacher">
        <div class="avatar"><a href="{% url 'view_user_profile' workshop.teacher.uid %}"><img src="{{ workshop.teacher.smaller_avatar_url }}" {% thumbnail_img_size 'avatar_smaller' %} /></a></div>
        <div class="name"><a href="{% url 'view_user_profile' workshop.teacher.uid %}">{{ workshop.teacher.name }}</a></div>
    </div>

    <div class="row workshop-pictures-enrollment">
        <div class="col-lg-8">
            <div class="workshop-pictures">
                <div id="pictures-slider" class="royalSlider rsDefault">
                    {% for picture in course_pictures %}
                        <img src="{{ picture.image|thumbnail_url:'course_picture_full' }}" alt="{{ picture.description }}" />
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="workshop-enrollment">
                <div class="head"><i class="icon-signin"></i> เข้าร่วมเวิร์คช็อป</div>

                <div class="enroll-schedule">
                    <label>รอบวันที่</label>
                    <a href="#modal-schedule-picker" class="btn btn-default button-schedule-picker" data-toggle="modal"><i class="icon-calendar"></i><span class="date">วันพฤหัสบดี, 1 ก.ย. 2556</span><span class="time">เวลา 16:00 - 18:00 น.</span></a>
                </div>

                <div class="enroll-seats">
                    <label>จำนวนคน</label>
                    <select>
                        <option value="1">1 คน</option>
                        <option value="2">2 คน</option>
                        <option value="3">3 คน</option>
                        <option value="4">4 คน</option>
                        <option value="5">5 คน</option>
                        <option value="6">6 คน</option>
                        <option value="7">7 คน</option>
                    </select>
                    <script>$('.workshop-enrollment .enroll-seats select').selectpicker({width: '100px'});</script>
                    <span class="price_per_person"><span class="x">x</span> <span class="price"><em>400</em> บาท</span></span>
                </div>

                <div class="enroll-button">
                    <a href="#" class="style-primary-button">ลงชื่อเข้าร่วม</a>
                </div>
            </div>
            <div class="workshop-social">
                <!-- TODO -->
            </div>
        </div>
    </div>

    <div class="workshop-story">
        <!--{{ course.description|safe }}-->
        <p>รีดไถเจล คลาสสิกห่วยฮาราคีรีว้าวไอติมเซี้ยว แพนงเชิญทำงานคอรัปชัน วานิลาแตงโมอพาร์ทเมนท์แฟรนไชส์งี้แอลมอนด์ เพทนาการไมค์ ติงต๊องบึมสังโฆทับซ้อน ซินโดรมเทรลเล่อร์ปัจเจกชนโอเปร่าคอรัปชันควีน แฟรีนรีแพทย์รอยัลตี้ฮองเฮา มาเฟียเมจิกเฟรชทำงานวอลซ์โพลารอยด์ แซ็กแอ็กชั่นกราวนด์เมจิกไทยแลนด์ รีพอร์ทลอร์ดสปาจีดีพีแอปเปิ้ล สังโฆอันเดอร์ภควัทคีตาอุด้ง มาร์ชโซนี่ พรีเมียร์อีสต์โหงวอุตสาหการ ออโต้ห่วยท็อปบูตคาปูชิโนแชมป์ หลินจือเนิร์สเซอรีไฮกุสหัสวรรษบอร์ดคันธาระ</p>
        <p>เซ็นทรัลปิโตรเคมีสโรชา เบลอ วอฟเฟิลรีสอร์ทคำสาป เหี่ยวย่นแมกกาซีนพงษ์ แฟรีสจ๊วตธรรมา สเตอริโอโบว์ลิ่งเยน ผู้นำสปิริตแกงค์เทค สปายแม่ค้าสเตเดียมไรเฟิลรีสอร์ต กิฟท์ เนอะราเม็งฮองเฮา ภควัทคีตาพุดดิ้ง สกรัมโปรดิวเซอร์ ติงต๊อง แคร็กเกอร์ พอเพียงไอซียูจูนรัมโฮปฟลุต ลอร์ดออร์เดอร์วอร์รูมสเตชันฟรุต</p>
        <p>พุทธภูมิโอเพ่นบราแบคโฮ ไฮเอนด์โปรเจ็คท์โปสเตอร์ยังไงฮาราคีรีเครป ตุ๊กอมาตยาธิปไตยคอรัปชันรีโมตกับดัก ว้อดก้า บุญคุณเกรดเบิร์ดเคลมกรอบรูปแจ๊กพอต ชีสเอ๋ไชน่า ดีพาร์ทเมนท์แบคโฮอีสต์เคอร์ฟิวแป๋วแคนยอน สไตล์โอเคสะบึมส์โปสเตอร์ เวิลด์พฤหัส ต้าอ่วยสามแยก ฟินิกซ์ต้าอ่วยบิลแพกเกจเจได ฮ็อตปอดแหกแก๊สโซฮอล์ไฮกุศิลปากรราเม็ง แอสเตอร์จุ๊ย รีโมทโต๊ะจีนแฟนตาซีอินเตอร์เฟอร์นิเจอร์เดโม เกรดเฟอร์นิเจอร์เซรามิกราเมนเบบี้ ราชานุญาตปิยมิตรปฏิสัมพันธ์โฮปแอดมิชชั่นกับดัก</p>
    </div>

    <div class="row workshop-activities-place">
        <div class="col-lg-5">
            <div class="workshop-activities">
                <div class="head"><i class="icon-th-list"></i> กิจกรรม</div>
                <ul>
                    <li>แซ็กโซโฟนโปรเจกต์อินดอร์ ซาตานเอสเพรสโซลิสต์แซลมอนฮิต สเต็ปง่าวจิตเภทเนิร์สเซอรีง่าว วีซ่าเจ็ตมหาอุปราชา</li>
                    <li>หยวนเตี๊ยมเซนเซอร์ คอมเมนต์ปิกอัพแพ็คทริป ศิรินทร์วัจนะ แบคโฮสกรัมควิก คอร์ปพาวเวอร์นิวส์พันธุวิศวกรรม คำสาปตังค์แจมบ๊วยอีสต์</li>
                    {% for activity in workshop.activities.all %}
                        <li>{{ activity.title }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="col-lg-7">
            <div class="workshop-place">
                <div class="head"><i class="icon-map-marker"></i> สถานที่</div>
                <div class="clearfix">
                    <div class="map"><a href="http://maps.google.com/maps?q={{ workshop.place.latlng }}"><img src="http://maps.googleapis.com/maps/api/staticmap?center={{ workshop.place.latlng }}&zoom=13&size=270x180&markers=color:red%7Clabel:S%7C{{ workshop.place.latlng }}&sensor=false" /></a></div>
                    <div class="place">
                        <div class="name">{{ workshop.place.name }}</div>
                        <div class="address">{{ workshop.place.address }}</div>
                        <div class="direction">
                            <div class="direction_head">How to get there</div>
                            {{ workshop.place.direction|linebreaks }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% if user.is_authenticated and user == workshop.teacher %}
    <div class="workshop-tools">
        <a href="{% url 'edit_workshop' workshop.uid %}" class="style-outline-button"><i class="icon-pencil"></i> Edit workshop</a>
        <a href="{% url 'manage_workshop_overview' workshop.uid %}" class="style-outline-button"><i class="icon-book"></i> Manage workshop</a>
    </div>
    {% endif %}

    <div class="workshop-feedbacks">
        <h2>คำนิยม</h2>
        <ul class="feedbacks">
            <li class="feedback style-course-feedback">
                <div class="feedback-avatar"><img src="{{ STATIC_URL }}images/sample/avatars/user4.jpg" width="50" height="50" /></div>
                <div class="feedback-right">
                    <div class="feedback-from"><a href="#">Sample Review</a> was feeling <em>excited</em></div>
                    <div class="feedback-content">
                        <p>เยอร์บีร่าโพลารอยด์เลกเชอร์ฟรุตแมนชั่นรวมมิตร งั้นเจลฮอตดอกพาสปอร์ตตนเองแพ็ค กับดักวัคค์ไฮเวย์วาทกรรม ห่วยเหมยเซาท์ เพรสอุปทาน ป๊อกนิวส์ปิยมิตรเฟอร์รี่เสือโคร่ง สามแยกเยอร์บีร่าแคร็กเกอร์โรแมนติคชะโนดโซนี่ ปาสคาลแต๋วไฮกุเช็ก</p>
                    </div>
                </div>
            </li>
            <li class="feedback style-course-feedback">
                <div class="feedback-avatar"><img src="{{ STATIC_URL }}images/sample/avatars/user4.jpg" width="50" height="50" /></div>
                <div class="feedback-right">
                    <div class="feedback-from"><a href="#">Sample Review</a> was feeling <em>excited</em></div>
                    <div class="feedback-content">
                        <p>เยอร์บีร่าโพลารอยด์เลกเชอร์ฟรุตแมนชั่นรวมมิตร งั้นเจลฮอตดอกพาสปอร์ตตนเองแพ็ค กับดักวัคค์ไฮเวย์วาทกรรม ห่วยเหมยเซาท์ เพรสอุปทาน ป๊อกนิวส์ปิยมิตรเฟอร์รี่เสือโคร่ง สามแยกเยอร์บีร่าแคร็กเกอร์โรแมนติคชะโนดโซนี่ ปาสคาลแต๋วไฮกุเช็ก</p>
                    </div>
                </div>
            </li>
            <li class="feedback style-course-feedback">
                <div class="feedback-avatar"><img src="{{ STATIC_URL }}images/sample/avatars/user4.jpg" width="50" height="50" /></div>
                <div class="feedback-right">
                    <div class="feedback-from"><a href="#">Sample Review</a> was feeling <em>excited</em></div>
                    <div class="feedback-content">
                        <p>เยอร์บีร่าโพลารอยด์เลกเชอร์ฟรุตแมนชั่นรวมมิตร งั้นเจลฮอตดอกพาสปอร์ตตนเองแพ็ค กับดักวัคค์ไฮเวย์วาทกรรม ห่วยเหมยเซาท์ เพรสอุปทาน ป๊อกนิวส์ปิยมิตรเฟอร์รี่เสือโคร่ง สามแยกเยอร์บีร่าแคร็กเกอร์โรแมนติคชะโนดโซนี่ ปาสคาลแต๋วไฮกุเช็ก</p>
                    </div>
                </div>
            </li>
            <li class="feedback style-course-feedback">
                <div class="feedback-avatar"><img src="{{ STATIC_URL }}images/sample/avatars/user4.jpg" width="50" height="50" /></div>
                <div class="feedback-right">
                    <div class="feedback-from"><a href="#">Sample Review</a> was feeling <em>excited</em></div>
                    <div class="feedback-content">
                        <p>เยอร์บีร่าโพลารอยด์เลกเชอร์ฟรุตแมนชั่นรวมมิตร งั้นเจลฮอตดอกพาสปอร์ตตนเองแพ็ค กับดักวัคค์ไฮเวย์วาทกรรม ห่วยเหมยเซาท์ เพรสอุปทาน ป๊อกนิวส์ปิยมิตรเฟอร์รี่เสือโคร่ง สามแยกเยอร์บีร่าแคร็กเกอร์โรแมนติคชะโนดโซนี่ ปาสคาลแต๋วไฮกุเช็ก</p>
                    </div>
                </div>
            </li>
            {% for feedback in feedbacks %}
                {% include 'snippets/course_feedback_box.html' %}
            {% endfor %}
        </ul>
    </div>
</div>

{% comment %}
<div class="course-schedules">
    <a name="join-workshop"></a>
    <div class="container">
        <div class="clearfix">
            <div class="schedules-calendar">
                <div id="enrollment-calendar"></div>
                <div class="legend"><i class="available"></i> Has available schedule</div>
            </div>
            <div class="schedules-list">
                <ul>
                    {% for schedule in course_schedules %}
                        <li{% if forloop.counter > 3 %} class="hide"{% endif %}>
                            <div class="schedule">
                                <span class="schedule-date"><i class="icon-calendar"></i> <em>วัน{{ schedule.start_datetime|date:'l' }},</em> {{ schedule.start_datetime|date:'j F Y' }}</span>
                                <span class="schedule-time"><i class="icon-time"></i> {{ schedule.start_datetime|date:'H:i' }} น. - {{ schedule|course_schedule_end_datetime|date:'H:i' }} น.</span>
                            </div>
                            <div class="join">
                                <div class="price">
                                    <span class="number">{{ course.price|floatformat:0 }} บาท</span>
                                    <span class="availability">เหลือที่ว่าง {{ schedule.stats_seats_left }} ที่นั่ง</span>
                                </div>
                                <div class="button">
                                    <a href="#modal-enrollment-confirm" class="style-orange-button" data-schedule-id="{{ schedule.id }}" data-price="{{ course.price|floatformat:0 }}" data-seats-left="{{ schedule.stats_seats_left }}" data-schedule-text="วัน{{ schedule.start_datetime|date:'l' }}, {{ schedule.start_datetime|date:'j F Y' }} เวลา {{ schedule.start_datetime|date:'H:i' }} น."><i class="icon-signin"></i> ลงชื่อ</a>
                                </div>
                            </div>
                        </li>
                        {% if forloop.counter == 4 %}
                            <li><a href="#" class="viewall button-show-all-schedules">View all schedules</a></li>
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>{% endcomment %}

{% endblock %}

{% block modals %}
{% include 'snippets/modal_enrollment_confirm.html' %}

<div class="modal fade" id="modal-schedule-picker">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">เลือกรอบ</h4>
            </div>
            <div class="modal-body">
                <table>
                    <tr>
                        <td class="datetime"><label><input type="radio" name="schedule" /> <span class="date">วันพฤหัสบดี, 1 ก.ย. 2556</span><span class="time">เวลา 16:00 - 18:00 น.</span></label></td>
                        <td class="availability">เหลือที่ว่าง 10 ที่นั่ง</td>
                        <td class="price"><span>400 บาท</span></td>
                    </tr>
                    <tr>
                        <td class="datetime"><label><input type="radio" name="schedule" /> <span class="date">วันพฤหัสบดี, 1 ก.ย. 2556</span><span class="time">เวลา 16:00 - 18:00 น.</span></label></td>
                        <td class="availability">เหลือที่ว่าง 10 ที่นั่ง</td>
                        <td class="price"><span>400 บาท</span></td>
                    </tr>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="style-primary-button">ตกลง</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}


{% block body1 %}

<!-- Similar Courses -->

<div class="modal fade hide" id="modal-enrollment-login"></div>

<div class="modal hide" id="modal-enrollment-payment">
{% if page_action == 'payment' and enrollment %}
{% include 'snippets/modal_enrollment_payment.html' %}
<script>$(document).ready(function($) {$('#modal-enrollment-payment').modal();});</script>
{% endif %}
</div>

{% endblock %}